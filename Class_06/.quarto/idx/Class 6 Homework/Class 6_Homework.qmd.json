{"title":"Homework Question 6","markdown":{"yaml":{"title":"Homework Question 6","author":"Carolina Merino (PID 14484883)","format":"html"},"headingText":"Q6. How would you generalize the original code above to work with any set of input protein structures?","containsRefs":false,"markdown":"\n\n\n### Description\nWe define a reusable R function that reads a protein PDB structure, extracts the alpha carbons from chain A, and plots the B-factor values. Using this function avoids repeating the same steps for each protein and allows easy comparison of protein flexibility with or without drug binding.\n\nOriginally, each protein required multiple lines of code to read, trim, extract B-factors, and plot. Writing a function consolidates these steps into a single reusable command, reducing code duplication, improving readability, and making the analysis more efficient.\n\n## Original analysis code:\n```{r}\n# Can you improve this analysis code?\nlibrary(bio3d)\ns1 <- read.pdb(\"4AKE\") # kinase with drug\ns2 <- read.pdb(\"1AKE\") # kinase no drug\ns3 <- read.pdb(\"1E4Y\") # kinase with drug\ns1.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns2.chainA <- trim.pdb(s2, chain=\"A\", elety=\"CA\")\ns3.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns1.b <- s1.chainA$atom$b\ns2.b <- s2.chainA$atom$b\ns3.b <- s3.chainA$atom$b\nplotb3(s1.b, sse=s1.chainA, typ=\"l\", ylab=\"Bfactor\")\nplotb3(s2.b, sse=s2.chainA, typ=\"l\", ylab=\"Bfactor\")\nplotb3(s3.b, sse=s3.chainA, typ=\"l\", ylab=\"Bfactor\")\n```\n\n\n## Let's download the library first\n\nThis chunk loads the bio3d package, which contains functions for working with protein structures (PDB files) such as read.pdb(), trim.pdb(), and plotb3().\n\n```{r}\nlibrary(bio3d) \n```\n\n## This function takes a protein’s PDB ID (for example, “4AKE”) and:\n\n- Downloads and reads its 3D structure.\n- Extracts only the alpha-carbon (CA) atoms from chain A.\n- Plots the B-factor (a measure of atomic flexibility) along the amino acid sequence.\n\n\n```{r}\n# Function to plot B-factors for a protein\nplot_protein_bfactor <- function(id, chain=\"A\") {\n  pdb <- read.pdb(id)                  # read protein structure\n  pdb_chain <- trim.pdb(pdb, chain=chain, elety=\"CA\")  # trim to chain A alpha carbons\n  plotb3(pdb_chain$atom$b, sse=pdb_chain, typ=\"l\",\n         ylab=\"B-factor\", main=id)     # plot B-factors\n}\n```\n\n## Here we can call the function for several example proteins to generate B-factor plots.\n\nExample:\n- 4AKE – kinase bound to a drug (inhibitor)\n- 1AKE – unbound kinase (apo form)\n- 1E4Y – another kinase–drug complex\n\n>Each plot shows the B-factor for residues in chain A.\nHigher B-factors correspond to greater flexibility or motion in that region of the protein.\n\n```{r}\nplot_protein_bfactor(\"4AKE\")  # kinase with drug\nplot_protein_bfactor(\"1AKE\")  # kinase without drug\nplot_protein_bfactor(\"1E4Y\")  # kinase with drug\n\n```\n>This explains why we need a function and what problem it solves compared to repeating code for each protein.\n\n## For the plots:\n\n- Regions with low B-factors are rigid and stable.\n- Regions with high B-factors are more flexible or disordered.\n- Comparing these plots shows how ligand binding (drug presence) changes the flexibility of specific parts of the protein.\n\n\n\n## Conclusion\nThe function `plot_protein_bfactor()` consolidates the repetitive steps of reading, trimming, and plotting B-factors for any protein, allowing comparisons across multiple proteins without rewriting the same code.","srcMarkdownNoYaml":"\n\n## Q6. How would you generalize the original code above to work with any set of input protein structures?\n\n### Description\nWe define a reusable R function that reads a protein PDB structure, extracts the alpha carbons from chain A, and plots the B-factor values. Using this function avoids repeating the same steps for each protein and allows easy comparison of protein flexibility with or without drug binding.\n\nOriginally, each protein required multiple lines of code to read, trim, extract B-factors, and plot. Writing a function consolidates these steps into a single reusable command, reducing code duplication, improving readability, and making the analysis more efficient.\n\n## Original analysis code:\n```{r}\n# Can you improve this analysis code?\nlibrary(bio3d)\ns1 <- read.pdb(\"4AKE\") # kinase with drug\ns2 <- read.pdb(\"1AKE\") # kinase no drug\ns3 <- read.pdb(\"1E4Y\") # kinase with drug\ns1.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns2.chainA <- trim.pdb(s2, chain=\"A\", elety=\"CA\")\ns3.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns1.b <- s1.chainA$atom$b\ns2.b <- s2.chainA$atom$b\ns3.b <- s3.chainA$atom$b\nplotb3(s1.b, sse=s1.chainA, typ=\"l\", ylab=\"Bfactor\")\nplotb3(s2.b, sse=s2.chainA, typ=\"l\", ylab=\"Bfactor\")\nplotb3(s3.b, sse=s3.chainA, typ=\"l\", ylab=\"Bfactor\")\n```\n\n\n## Let's download the library first\n\nThis chunk loads the bio3d package, which contains functions for working with protein structures (PDB files) such as read.pdb(), trim.pdb(), and plotb3().\n\n```{r}\nlibrary(bio3d) \n```\n\n## This function takes a protein’s PDB ID (for example, “4AKE”) and:\n\n- Downloads and reads its 3D structure.\n- Extracts only the alpha-carbon (CA) atoms from chain A.\n- Plots the B-factor (a measure of atomic flexibility) along the amino acid sequence.\n\n\n```{r}\n# Function to plot B-factors for a protein\nplot_protein_bfactor <- function(id, chain=\"A\") {\n  pdb <- read.pdb(id)                  # read protein structure\n  pdb_chain <- trim.pdb(pdb, chain=chain, elety=\"CA\")  # trim to chain A alpha carbons\n  plotb3(pdb_chain$atom$b, sse=pdb_chain, typ=\"l\",\n         ylab=\"B-factor\", main=id)     # plot B-factors\n}\n```\n\n## Here we can call the function for several example proteins to generate B-factor plots.\n\nExample:\n- 4AKE – kinase bound to a drug (inhibitor)\n- 1AKE – unbound kinase (apo form)\n- 1E4Y – another kinase–drug complex\n\n>Each plot shows the B-factor for residues in chain A.\nHigher B-factors correspond to greater flexibility or motion in that region of the protein.\n\n```{r}\nplot_protein_bfactor(\"4AKE\")  # kinase with drug\nplot_protein_bfactor(\"1AKE\")  # kinase without drug\nplot_protein_bfactor(\"1E4Y\")  # kinase with drug\n\n```\n>This explains why we need a function and what problem it solves compared to repeating code for each protein.\n\n## For the plots:\n\n- Regions with low B-factors are rigid and stable.\n- Regions with high B-factors are more flexible or disordered.\n- Comparing these plots shows how ligand binding (drug presence) changes the flexibility of specific parts of the protein.\n\n\n\n## Conclusion\nThe function `plot_protein_bfactor()` consolidates the repetitive steps of reading, trimming, and plotting B-factors for any protein, allowing comparisons across multiple proteins without rewriting the same code."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Class 6_Homework.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","editor":"visual","title":"Homework Question 6","author":"Carolina Merino (PID 14484883)"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}