{
  "hash": "be867b36b73a266808894d0d822ee030",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework Question 6\"\nauthor: \"Carolina Merino (PID 14484883)\"\nformat: html\n---\n\n## Q6. How would you generalize the original code above to work with any set of input protein structures?\n\n### Description\nWe define a reusable R function that reads a protein PDB structure, extracts the alpha carbons from chain A, and plots the B-factor values. Using this function avoids repeating the same steps for each protein and allows easy comparison of protein flexibility with or without drug binding.\n\nOriginally, each protein required multiple lines of code to read, trim, extract B-factors, and plot. Writing a function consolidates these steps into a single reusable command, reducing code duplication, improving readability, and making the analysis more efficient.\n\n## Original analysis code:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Can you improve this analysis code?\nlibrary(bio3d)\ns1 <- read.pdb(\"4AKE\") # kinase with drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n```\n\n\n:::\n\n```{.r .cell-code}\ns2 <- read.pdb(\"1AKE\") # kinase no drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n   PDB has ALT records, taking A only, rm.alt=TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\ns3 <- read.pdb(\"1E4Y\") # kinase with drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n```\n\n\n:::\n\n```{.r .cell-code}\ns1.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns2.chainA <- trim.pdb(s2, chain=\"A\", elety=\"CA\")\ns3.chainA <- trim.pdb(s1, chain=\"A\", elety=\"CA\")\ns1.b <- s1.chainA$atom$b\ns2.b <- s2.chainA$atom$b\ns3.b <- s3.chainA$atom$b\nplotb3(s1.b, sse=s1.chainA, typ=\"l\", ylab=\"Bfactor\")\n```\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplotb3(s2.b, sse=s2.chainA, typ=\"l\", ylab=\"Bfactor\")\n```\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplotb3(s3.b, sse=s3.chainA, typ=\"l\", ylab=\"Bfactor\")\n```\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n\n\n\n## Let's download the library first\n\nThis chunk loads the bio3d package, which contains functions for working with protein structures (PDB files) such as read.pdb(), trim.pdb(), and plotb3().\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bio3d) \n```\n:::\n\n\n## This function takes a protein’s PDB ID (for example, “4AKE”) and:\n\n- Downloads and reads its 3D structure.\n- Extracts only the alpha-carbon (CA) atoms from chain A.\n- Plots the B-factor (a measure of atomic flexibility) along the amino acid sequence.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to plot B-factors for a protein\nplot_protein_bfactor <- function(id, chain=\"A\") {\n  pdb <- read.pdb(id)                  # read protein structure\n  pdb_chain <- trim.pdb(pdb, chain=chain, elety=\"CA\")  # trim to chain A alpha carbons\n  plotb3(pdb_chain$atom$b, sse=pdb_chain, typ=\"l\",\n         ylab=\"B-factor\", main=id)     # plot B-factors\n}\n```\n:::\n\n\n## Here we can call the function for several example proteins to generate B-factor plots.\n\nExample:\n- 4AKE – kinase bound to a drug (inhibitor)\n- 1AKE – unbound kinase (apo form)\n- 1E4Y – another kinase–drug complex\n\n>Each plot shows the B-factor for residues in chain A.\nHigher B-factors correspond to greater flexibility or motion in that region of the protein.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_protein_bfactor(\"4AKE\")  # kinase with drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in get.pdb(file, path = tempdir(), verbose = FALSE):\nC:\\Users\\LINDAK~1\\AppData\\Local\\Temp\\RtmpyCgqP1/4AKE.pdb exists. Skipping\ndownload\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_protein_bfactor(\"1AKE\")  # kinase without drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in get.pdb(file, path = tempdir(), verbose = FALSE):\nC:\\Users\\LINDAK~1\\AppData\\Local\\Temp\\RtmpyCgqP1/1AKE.pdb exists. Skipping\ndownload\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   PDB has ALT records, taking A only, rm.alt=TRUE\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_protein_bfactor(\"1E4Y\")  # kinase with drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Note: Accessing on-line PDB file\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in get.pdb(file, path = tempdir(), verbose = FALSE):\nC:\\Users\\LINDAK~1\\AppData\\Local\\Temp\\RtmpyCgqP1/1E4Y.pdb exists. Skipping\ndownload\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Class-6_Homework_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n>This explains why we need a function and what problem it solves compared to repeating code for each protein.\n\n## For the plots:\n\n- Regions with low B-factors are rigid and stable.\n- Regions with high B-factors are more flexible or disordered.\n- Comparing these plots shows how ligand binding (drug presence) changes the flexibility of specific parts of the protein.\n\n\n\n## Conclusion\nThe function `plot_protein_bfactor()` consolidates the repetitive steps of reading, trimming, and plotting B-factors for any protein, allowing comparisons across multiple proteins without rewriting the same code.",
    "supporting": [
      "Class-6_Homework_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}